    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Pet Products</title>
        <link rel="stylesheet" href="../css/style.css">
        <link rel="stylesheet" href="../css/responsive.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">
    </head>
    <body>
        <header>
        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%; padding: 0 1em;">
        <img id="logo" src="../img/logo/schnauzer-face-svgrepo-com.svg" alt="Logo">
        <h1>PAW HAVEN</h1>
            <select id="menu" name="menu">
                <option value="">Main menu</option> <!-- Empty value for placeholder -->
                <option value="../index.html">Home</option>
                <option value="kontakt.html">Kontakt</option>
                <option value="o-nama.html">O nama</option>
            </select>
        </div>
        </header>
        <main id="proizvodi">
            <nav aria-label="Breadcrumb">
                <ol class="breadcrumb">
                    <li><a href="../index.html">Home</a></li>
                    <li>Shop</li>
                </ol>
            </nav>
            <h1>Quality Pet Supplies for Dogs & Cats</h1>
            <a href="../pages/kosarica.html" id="cart-toggle" class="cart-link">üõí Cart (<span id="cart-count">0</span>)</a>
            <div class="container">
                <aside class="sidebar">
                    <h3>Filter By</h3>

                    <div class="filter-group">
                    <h4>Category</h4>
                    <label><input type="checkbox" name="category" value="dog"> Dog Supplies</label><br>
                    <label><input type="checkbox" name="category" value="cat"> Cat Supplies</label>
                    </div>

                    <div class="filter-group">
                    <h4>Price</h4>
                    <label><input type="radio" name="price" value="under20"> Under $20</label><br>
                    <label><input type="radio" name="price" value="20to50"> $20‚Äì$50</label><br>
                    <label><input type="radio" name="price" value="over50"> Over $50</label><br>
                    <label><input type="radio" name="price" value="all" checked> All Prices</label>
                    </div>
                </aside>

            <div class="main-content">
                <div class="sorting">
                    <label for="sort">Sort by:</label>
                    <select id="sort">
                    <option value="popular">Most Popular</option>
                    <option value="price-low-high">Price: Low to High</option>
                    <option value="price-high-low">Price: High to Low</option>
                    <option value="newest">Newest First</option>
                    </select>
                </div>

                <div class="product-grid">
                    <!-- Products will be dynamically inserted here by JavaScript -->
                </div>

                <div class="pagination">
                    <!-- Pagination links will be generated by JavaScript -->
                </div>
            </div>
        </main>
        <footer>
          <div class="footer-container">
              <div class="footer-column" id="footer-about">
                  <h4>PAW HAVEN</h4> <!-- Or your webshop name -->
                  <p>Providing the best for your furry friends. Quality supplies and expert advice.</p>
                  <p class="copyright">¬© 2024 PAW HAVEN. All rights reserved.</p>
              </div>

              <div class="footer-column" id="footer-nav">
                  <h4>Quick Links</h4>
                  <ul id="footer-menu">
                      <li><a href="/pages/o-nama.html">About Us</a></li>
                      <li><a href="/pages/kontakt.html">Contact Us</a></li>
                      <li><a href="/blog.html">Blog</a></li>
                      <li><a href="/pages/proizvodi.html">Shop All Products</a></li>
                  </ul>
              </div>

              <div class="footer-column" id="footer-contact">
                  <h4>Contact Us</h4>
                  <p><span class="icon">üìç</span> Lorem Ipsum 123,<br>10000 Zagreb, Croatia</p>
                  <p><span class="icon">‚úâÔ∏è</span> <a href=" ">info@pawhaven.hr</a></p>
                  <p><span class="icon">üìû</span> <a href="tel:+3859142487">+385 1 2345 678</a></p>
              </div>

              <div class="footer-column" id="footer-social">
                  <h4>Follow Us</h4>
                  <div class="social-icons">
                      <a href="https://facebook.com" target="_blank" aria-label="Facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-facebook" viewBox="0 0 16 16">
                            <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"/>
                        </svg>
                      </a>
                      <a href="https://instagram.com" target="_blank" aria-label="Instagram">
                        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-instagram" viewBox="0 0 16 16">
                            <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.9 3.9 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233s.008-2.388.046-3.231c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92m-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217m0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"/>
                        </svg>
                      </a>
                      <a href="https://twitter.com" target="_blank" aria-label="Twitter">
                        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-twitter-x" viewBox="0 0 16 16">
                            <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"/>
                        </svg>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
        <script src="../js/cart.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', async () => { // Make it async
                // ... (cart count logic) ...

                const productGrid = document.querySelector('.product-grid');
                let allProductsData = []; // This will be populated from JSON

                const sortSelect = document.getElementById('sort');
                const categoryCheckboxes = document.querySelectorAll('.sidebar .filter-group input[type="checkbox"][name="category"]');
                const priceRadios = document.querySelectorAll('.sidebar .filter-group input[type="radio"][name="price"]');
                const paginationContainer = document.querySelector('.pagination');

                const productsPerPage = 6;
                let currentPage = 1;
                let filteredAndSortedProducts = [];

                async function loadAndInitializeProducts() {
                    try {
                        const response = await fetch('../data/products.json'); // Adjust path if your products.json is elsewhere
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        const productsJson = await response.json();

                        allProductsData = productsJson.map((prod, index) => {
                            // Create the product card element dynamically
                            const card = document.createElement('div');
                            card.classList.add('product-card');
                            // Set data attributes on the card itself for easy access if needed by cart.js or details navigation
                            card.dataset.name = prod.name;
                            card.dataset.price = prod.price;
                            card.dataset.image = prod.image;
                            card.dataset.sku = prod.sku;
                            card.dataset.category = prod.category;
                            card.dataset.shortDescription = prod.shortDescription;
                            card.dataset.longDescription = prod.longDescription;


                            card.innerHTML = `
                                <img class="product-image" src="${prod.image}" alt="${prod.name}">
                                <h4>${prod.name}</h4>
                                <p>$${parseFloat(prod.price).toFixed(2)}</p>
                                <div class="buttons-container">
                                    <button class="add-to-cart">Add to Cart</button>
                                    <button class="details-button">View Details</button>
                                </div>
                            `;
                            return {
                                element: card, // The dynamically created DOM element
                                id: index, // Original index for stable "popular" sort
                                name: prod.name,
                                price: parseFloat(prod.price),
                                image: prod.image,
                                sku: prod.sku,
                                category: prod.category,
                                shortDescription: prod.shortDescription,
                                longDescription: prod.longDescription,
                            };
                        });

                        applyFiltersAndSort(); // Initial filter, sort, and render

                    } catch (error) {
                        console.error("Could not fetch or initialize products:", error);
                        productGrid.innerHTML = "<p style='color:white; text-align:center;'>Error loading products. Please try again later.</p>";
                    }
                }


                function applyFiltersAndSort() {
                    let productsToShow = [...allProductsData];

                    // 1. Category Filter
                    const selectedCategories = Array.from(categoryCheckboxes)
                        .filter(cb => cb.checked)
                        .map(cb => cb.value);

                    if (selectedCategories.length > 0) {
                        productsToShow = productsToShow.filter(p => selectedCategories.includes(p.category));
                    }

                    // 2. Price Filter
                    const selectedPriceRadio = Array.from(priceRadios).find(radio => radio.checked);
                    if (selectedPriceRadio && selectedPriceRadio.value !== "all") {
                        const priceValue = selectedPriceRadio.value;
                        productsToShow = productsToShow.filter(p => {
                            if (priceValue === 'under20') return p.price < 20;
                            if (priceValue === '20to50') return p.price >= 20 && p.price <= 50;
                            if (priceValue === 'over50') return p.price > 50;
                            return true;
                        });
                    }

                    // 3. Sorting
                    const sortBy = sortSelect.value;
                    switch (sortBy) {
                        case 'price-low-high':
                            productsToShow.sort((a, b) => a.price - b.price);
                            break;
                        case 'price-high-low':
                            productsToShow.sort((a, b) => b.price - a.price);
                            break;
                        case 'newest':
                            productsToShow.sort((a, b) => b.id - a.id); // Assuming higher id means newer
                            break;
                        case 'popular':
                        default:
                            productsToShow.sort((a, b) => a.id - b.id); // Default order
                            break;
                    }

                    filteredAndSortedProducts = productsToShow;
                    currentPage = 1;
                    renderProductGrid();
                    updatePaginationControls();
                }

                function renderProductGrid() {
                    productGrid.innerHTML = '';

                    const startIndex = (currentPage - 1) * productsPerPage;
                    const endIndex = startIndex + productsPerPage;
                    const productsToDisplayOnPage = filteredAndSortedProducts.slice(startIndex, endIndex);

                    if (productsToDisplayOnPage.length === 0) {
                        const noProductsMessage = document.createElement('p');
                        noProductsMessage.textContent = 'No products match your criteria.';
                        noProductsMessage.style.color = 'white';
                        noProductsMessage.style.textAlign = 'center';
                        noProductsMessage.style.gridColumn = '1 / -1';
                        productGrid.appendChild(noProductsMessage);
                    } else {
                        productsToDisplayOnPage.forEach(productData => {
                            // Attach "View Details" listener specifically to this dynamically created element's button
                            const detailsButton = productData.element.querySelector('.details-button');
                            if (detailsButton) {
                                detailsButton.addEventListener('click', () => {
                                    const params = new URLSearchParams();
                                    params.append('name', productData.name);
                                    params.append('price', String(productData.price));
                                    params.append('image', productData.image);
                                    params.append('sku', productData.sku);
                                    params.append('shortDescription', productData.shortDescription);
                                    params.append('longDescription', productData.longDescription);
                                    params.append('category', productData.category);
                                    window.location.href = `../pages/pojedinacni-proizvod.html?${params.toString()}`;
                                });
                            }
                            // The "Add to Cart" button will be handled by the event delegation in cart.js
                            // using the data-* attributes set on productData.element (the card itself).
                            productGrid.appendChild(productData.element);
                        });
                    }
                }

                function updatePaginationControls() {
                    paginationContainer.innerHTML = '';
                    const totalPages = Math.ceil(filteredAndSortedProducts.length / productsPerPage);

                    if (totalPages <= 1) {
                        return;
                    }

                    if (currentPage > 1) {
                        const prevButton = document.createElement('a');
                        prevButton.href = '#prev';
                        prevButton.classList.add('page-link');
                        prevButton.innerHTML = '¬´ Prev';
                        prevButton.addEventListener('click', (e) => {
                            e.preventDefault();
                            currentPage--;
                            renderProductGrid();
                            updatePaginationControls();
                        });
                        paginationContainer.appendChild(prevButton);
                    }

                    for (let i = 1; i <= totalPages; i++) {
                        const pageLink = document.createElement('a');
                        pageLink.href = '#' + i;
                        pageLink.classList.add('page-link');
                        pageLink.textContent = i;
                        if (i === currentPage) {
                            pageLink.classList.add('active');
                        }
                        pageLink.addEventListener('click', (e) => {
                            e.preventDefault();
                            currentPage = i;
                            renderProductGrid();
                            updatePaginationControls();
                        });
                        paginationContainer.appendChild(pageLink);
                    }

                    if (currentPage < totalPages) {
                        const nextButton = document.createElement('a');
                        nextButton.href = '#next';
                        nextButton.classList.add('page-link');
                        nextButton.innerHTML = 'Next ¬ª';
                        nextButton.addEventListener('click', (e) => {
                            e.preventDefault();
                            currentPage++;
                            renderProductGrid();
                            updatePaginationControls();
                        });
                        paginationContainer.appendChild(nextButton);
                    }
                }

                // Event Listeners
                sortSelect.addEventListener('change', applyFiltersAndSort);
                priceRadios.forEach(radio => radio.addEventListener('change', applyFiltersAndSort));
                categoryCheckboxes.forEach(checkbox => checkbox.addEventListener('change', applyFiltersAndSort));

                // Initial Load
                await loadAndInitializeProducts();
            });
    </script>
    </body>
    </html>